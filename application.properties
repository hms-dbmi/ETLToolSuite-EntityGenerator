# ============================================================================
# Optimized CSV Processing Configuration
# RemoveConsentZeroPatients - Billion-Row Scale Processing
# ============================================================================

# CSV Parser Configuration
# ----------------------------------------------------------------------------
# Delimiter character for CSV files (default: comma)
csv.delimiter=,

# Quote character for CSV fields (default: double quote)
csv.quote="

# Escape character for special characters (default: backslash)
csv.escape=\\

# Whether to trim whitespace from CSV fields (default: true)
csv.trim.fields=true

# Expected number of fields per CSV line for allocation optimization
# Set this to the actual field count in your CSV files for best performance
csv.expected.field.count=5


# Processing Configuration
# ----------------------------------------------------------------------------
# Number of rows to batch before writing to disk
# Higher values = better throughput but more memory usage
# Recommended: 10000-50000 for billion-row processing
processing.write.batch.size=10000

# Number of rows to process in a single chunk
# Affects parallel processing granularity
# Recommended: 100000-500000
processing.chunk.size=100000

# Enable parallel processing within files (default: true)
# Set to false for debugging or if encountering issues
processing.parallel.enabled=true

# Level of parallelism (number of threads)
# Default: number of available processors
# For billion-row scale, set this to CPU core count
# Leave blank to auto-detect
processing.parallelism.level=


# Bloom Filter Configuration
# ----------------------------------------------------------------------------
# False positive probability for bloom filter (default: 0.01 = 1%)
# Lower values = more memory but fewer false positives
# Range: 0.001 (0.1%) to 0.05 (5%)
# Recommended: 0.01 for billion-row scale
bloomfilter.false.positive.rate=0.01


# Memory Configuration
# ----------------------------------------------------------------------------
# Maximum memory usage in MB (for monitoring alerts)
# Should be set to ~80% of JVM heap size
memory.max.mb=8192

# Enable memory usage monitoring (default: true)
# Monitors heap usage and GC statistics
memory.monitoring.enabled=true


# Logging Configuration
# ----------------------------------------------------------------------------
# Enable verbose logging (default: false)
# WARNING: Verbose logging can significantly impact performance
# Only enable for debugging small datasets
logging.verbose=false

# Enable performance logging (default: true)
# Logs throughput, memory, and timing statistics
logging.performance.enabled=true

# Progress report interval in rows (default: 1000000)
# How often to log progress updates
logging.progress.interval=1000000


# Directory Configuration
# ----------------------------------------------------------------------------
# Input directory containing files before consent removal
dir.before.removal=./beforeRemoval/

# Temporary processing directory
dir.processing=./processing/

# Output directory for processed files
dir.output=./data/


# ============================================================================
# PERFORMANCE TUNING NOTES
# ============================================================================
#
# For billion-row processing (1B+ rows):
# ---------------------------------------
# 1. Set JVM heap size to 16-32GB:
#    -Xmx32g -Xms32g
#
# 2. Use G1GC or ZGC for low-latency GC:
#    -XX:+UseG1GC -XX:MaxGCPauseMillis=200
#    OR
#    -XX:+UseZGC
#
# 3. Enable large pages for better memory performance:
#    -XX:+UseLargePages
#
# 4. Tune write batch size based on available memory:
#    - 16GB heap: processing.write.batch.size=10000
#    - 32GB heap: processing.write.batch.size=20000
#    - 64GB heap: processing.write.batch.size=50000
#
# 5. Set parallelism to physical core count (not hyperthreads):
#    processing.parallelism.level=16  (for 16-core CPU)
#
# 6. For NVMe/SSD storage, increase chunk size:
#    processing.chunk.size=500000
#
# 7. Adjust bloom filter FPR based on memory availability:
#    - Tight memory: bloomfilter.false.positive.rate=0.05
#    - Ample memory: bloomfilter.false.positive.rate=0.001
#
# ============================================================================
# ENVIRONMENT VARIABLE OVERRIDES
# ============================================================================
#
# Any property can be overridden via environment variables by:
# 1. Converting property name to uppercase
# 2. Replacing dots with underscores
#
# Examples:
#   export CSV_DELIMITER=','
#   export PROCESSING_WRITE_BATCH_SIZE=20000
#   export BLOOMFILTER_FALSE_POSITIVE_RATE=0.005
#   export LOGGING_VERBOSE=true
#
# Environment variables take precedence over this file.
#
# ============================================================================
